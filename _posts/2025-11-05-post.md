---
layout: post
title: "2025-11-05"
date: 2025-11-06 00:51:56 +0900
categories: [KRAFTON JUNGLE]
tags: [Programming]
---
---


# Today's Log(2025-11-05)
>ì˜¤ëŠ˜ì€ Week08ì˜ ë§ˆì§€ë§‰ë‚ ì´ë‹¤ ì´ë²ˆ ì£¼ì°¨ë¶€í„° ì›¹ ì„œë²„ ì œì‘ì— ë“¤ì–´ê°„ë‹¤.

---

## ì˜¤ëŠ˜ í•œ ì¼
- Proxy.c ê°œë… ê³µë¶€
- Proxy.c ì™„ì„±(ì„ì‹œ)


---

## TIL

### Proxy

ë§ˆì¹˜ ëŒ€ë¦¬ì¸ì´ë‚˜ ì¤‘ê°œì¸ì²˜ëŸ¼ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ì‚¬ì´ì—ì„œ í•µì‹¬ì ì¸ ì—­í• ì„ ìˆ˜í–‰

#### í”„ë¡ì‹œ(Proxy)ë€ ë¬´ì—‡ì¸ê°€
ë„¤íŠ¸ì›Œí¬ì—ì„œ í”„ë¡ì‹œ ì„œë²„ëŠ” **í´ë¼ì´ì–¸íŠ¸(ì‚¬ìš©ì)**ì™€ **ì›¹ ì„œë²„(ëª©ì ì§€)** ì‚¬ì´ì— ìœ„ì¹˜í•˜ì—¬ ë‘ ì—”í‹°í‹° ì‚¬ì´ì˜ í†µì‹ ì„ **ëŒ€ë¦¬(ì¤‘ê³„)**í•˜ëŠ” ì„œë²„ë¥¼ ì˜ë¯¸í•œë‹¤.

í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ì•„ ì›¹ ì„œë²„ë¡œ ì „ë‹¬í•˜ê³ , ì›¹ ì„œë²„ì˜ ì‘ë‹µì„ ë°›ì•„ í´ë¼ì´ì–¸íŠ¸ë¡œ ë‹¤ì‹œ ì „ë‹¬í•˜ëŠ” ì¤‘ê°„ë‹¤ë¦¬ ì—­í• ì„ í•œë‹¤.

ì›í•˜ëŠ” ë¬¼ê±´ì„ ì‚¬ê¸° ìœ„í•´ ì§ì ‘ ê°€ê²Œì— ê°€ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì¤‘ê°„ì— 'ì‹¬ë¶€ë¦„ê¾¼(í”„ë¡ì‹œ ì„œë²„)'ì„ ë‘ì–´ ëŒ€ì‹  ë¬¼ê±´ì„ ì‚¬ì„œ ì „ë‹¬ë°›ëŠ” ê²ƒê³¼ ê°™ë‹¤.

í”„ë¡ì‹œ ì„œë²„ë¥¼ í†µí•œ ì¼ë°˜ì ì¸ ì›¹ ìš”ì²­ì˜ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

í´ë¼ì´ì–¸íŠ¸ ìš”ì²­: í´ë¼ì´ì–¸íŠ¸(ë¸Œë¼ìš°ì €)ê°€ ì›¹ ì„œë²„(ëª©ì ì§€)ì— íŠ¹ì • ì›¹ í˜ì´ì§€ë‚˜ ìì›ì„ ìš”ì²­í•œë‹¤. ì´ ìš”ì²­ì€ í”„ë¡ì‹œ ì„œë²„ë¡œ í–¥í•œë‹¤.

í”„ë¡ì‹œ ì„œë²„ ìˆ˜ì‹  ë° ì²˜ë¦¬: í”„ë¡ì‹œ ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ìœ¼ë©° ì´ë•Œ, í”„ë¡ì‹œ ì„œë²„ëŠ” ìºì‹œ(Cache)ì— ìš”ì²­í•œ ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤. 

ìš”ì²­í•œ ë°ì´í„°ê°€ ìˆì„ ê²½ìš° ìºì‹œíˆíŠ¸ ì—†ì„ ê²½ìš° ìºì‹œë¯¸ìŠ¤ê°€ ë°œìƒí•œë‹¤. 

- ìºì‹œ íˆíŠ¸(Cache Hit)ë€ ìºì‹œì— ë°ì´í„°ê°€ ìˆìœ¼ë©´, ì›¹ ì„œë²„ì— ì ‘ì†í•˜ì§€ ì•Šê³  í”„ë¡ì‹œ ì„œë²„ê°€ ë°”ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì‘ë‹µí•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.

- ìºì‹œ ë¯¸ìŠ¤(Cache Miss): ìºì‹œì— ë°ì´í„°ê°€ ì—†ê±°ë‚˜ ìµœì‹  ë²„ì „ì´ ì•„ë‹ˆë©´, ì›¹ ì„œë²„ë¡œ ìš”ì²­ì„ ì „ë‹¬í•œë‹¤. (ì´ë•Œ í´ë¼ì´ì–¸íŠ¸ì˜ IP ì£¼ì†ŒëŠ” í”„ë¡ì‹œ ì„œë²„ì˜ IPë¡œ ëŒ€ì²´ë  ìˆ˜ ìˆë‹¤.)

ì›¹ ì„œë²„ ì‘ë‹µ: ì›¹ ì„œë²„ëŠ” í”„ë¡ì‹œ ì„œë²„ë¡œë¶€í„° ìš”ì²­ì„ ë°›ê³ , ìš”ì²­ëœ ìì›ì„ í”„ë¡ì‹œ ì„œë²„ë¡œ ì‘ë‹µí•œë‹¤.

í´ë¼ì´ì–¸íŠ¸ ì „ë‹¬: í”„ë¡ì‹œ ì„œë²„ëŠ” ì›¹ ì„œë²„ì˜ ì‘ë‹µì„ ë°›ì•„ (í•„ìš”í•˜ë‹¤ë©´ ìºì‹œì— ì €ì¥í•œ í›„) ìµœì¢…ì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•œë‹¤.
```
    A(í´ë¼ì´ì–¸íŠ¸(ì‚¬ìš©ì))
    B(í”„ë¡ì‹œ ì„œë²„)
    C(ì›¹ ì„œë²„(ëª©ì ì§€))

    A -- "1. ìš”ì²­" --> B;
    B -- "2. ìš”ì²­ ì „ë‹¬ (í”„ë¡ì‹œ IPë¡œ ë³€í™˜)" --> C;
    C -- "3. ì‘ë‹µ" --> B;
    B -- "4. ì‘ë‹µ ì „ë‹¬" --> A;

```   
#### í”„ë¡ì‹œ ì„œë²„ë¥¼ ì™œ ì‚¬ìš©í•˜ëŠ”ê°€

í”„ë¡ì‹œ ì„œë²„ëŠ” ë‹¨ìˆœí•œ ì¤‘ê³„ ì´ìƒì˜ ë‹¤ì–‘í•œ ì´ì ì„ ì œê³µí•œë‹¤.

- **ë³´ì•ˆ ë° ìµëª…ì„±** : í´ë¼ì´ì–¸íŠ¸ì˜ ì‹¤ì œ IP ì£¼ì†Œë¥¼ ì›¹ ì„œë²„ì— ë…¸ì¶œì‹œí‚¤ì§€ ì•Šê³  í”„ë¡ì‹œ ì„œë²„ì˜ IPë¡œ ëŒ€ì‹ í•˜ì—¬ ìµëª…ì„±ì„ ì œê³µí•˜ê³ , í´ë¼ì´ì–¸íŠ¸ì˜ ì •ë³´ë¥¼ ë³´í˜¸ í•  ìˆ˜ ìˆë‹¤.

 ì™¸ë¶€ì—ì„œì˜ ì§ì ‘ì ì¸ ì ‘ê·¼ì„ ë§‰ëŠ” ë°©í™”ë²½ ì—­í• ì„ ìˆ˜í–‰í•˜ì—¬ ë‚´ë¶€ ì„œë²„ë¥¼ ë³´í˜¸í•  ìˆ˜ ìˆë‹¤. (ì£¼ë¡œ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ)
 
- **ì„±ëŠ¥ í–¥ìƒ (ìºì‹±)** : ìì£¼ ìš”ì²­ë˜ëŠ” ë°ì´í„°ë¥¼ í”„ë¡ì‹œ ì„œë²„ì˜ ìºì‹œì— ì €ì¥í•´ ë‘” í›„ 
ë™ì¼í•œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì›¹ ì„œë²„ì— ë‹¤ì‹œ ìš”ì²­í•˜ì§€ ì•Šê³  ë°”ë¡œ ì‘ë‹µí•˜ì—¬ ì‘ë‹µ ì†ë„ë¥¼ ë†’ì´ê³  ì™¸ë¶€ íŠ¸ë˜í”½ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤.

- **ì ‘ê·¼ ì œì–´ ë° í•„í„°ë§ (ACL)** : ì¡°ì§ ë‚´ë¶€ ì‚¬ìš©ìì˜ ì¸í„°ë„· ì ‘ê·¼ì„ í†µì œí•˜ê±°ë‚˜(ì˜ˆ: íŠ¹ì • ìœ í•´ ì‚¬ì´íŠ¸ ì°¨ë‹¨), ì™¸ë¶€ì—ì„œì˜ íŠ¹ì • ì ‘ê·¼ì„ ì œí•œí•˜ëŠ” **ì ‘ê·¼ ì •ì±…(ACL)**ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.

- **ë¡œë“œ ë°¸ëŸ°ì‹± (ë¶€í•˜ ë¶„ì‚°)** : ì—¬ëŸ¬ ëŒ€ì˜ ì›¹ ì„œë²„ ì•ì— í”„ë¡ì‹œ ì„œë²„ë¥¼ ë‘ì–´, í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ì„œë²„ë“¤ì˜ ë¶€í•˜ì— ë”°ë¼ ì ì ˆíˆ ë¶„ë°°í•˜ì—¬ ì‹œìŠ¤í…œì˜ ê°€ìš©ì„±ê³¼ ì„±ëŠ¥ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤. (ì£¼ë¡œ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ)

#### í”„ë¡ì‹œ ì„œë²„ì˜ ì¢…ë¥˜
í¬ì›Œë“œ vs ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ
í”„ë¡ì‹œ ì„œë²„ëŠ” ë„¤íŠ¸ì›Œí¬ì—ì„œ ì–´ëŠ ìª½ì— ìœ„ì¹˜í•˜ë©° ëˆ„êµ¬ë¥¼ ëŒ€ì‹ í•˜ëŠëƒì— ë”°ë¼ í¬ê²Œ í¬ì›Œë“œ í”„ë¡ì‹œì™€ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¡œ ë‚˜ë‰œë‹¤.

- **í¬ì›Œë“œ í”„ë¡ì‹œ (Forward Proxy)** 
ìœ„ì¹˜ :  í´ë¼ì´ì–¸íŠ¸ ì• (ì£¼ë¡œ ë‚´ë¶€ë§)
ëŒ€ë¦¬ ëŒ€ìƒ : í´ë¼ì´ì–¸íŠ¸(ì‚¬ìš©ì) 
ëª©ì  : í´ë¼ì´ì–¸íŠ¸ ë³´í˜¸ (ìµëª…ì„±, ì ‘ê·¼ ì œì–´, ìºì‹±)
ì‘ë™ : í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•˜ë©´, í”„ë¡ì‹œê°€ ëª©ì ì§€ ì„œë²„ì— ìš”ì²­ì„ ì „ë‹¬í•˜ê³  ì‘ë‹µì„ ë°›ì•„ ë‹¤ì‹œ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬
```
    A(í´ë¼ì´ì–¸íŠ¸(ì‚¬ìš©ì))
    B(í”„ë¡ì‹œ ì„œë²„)
    C(ì›¹ ì„œë²„(ëª©ì ì§€))
    
    A--> ìš”ì²­ -- > B;
    B --> ëŒ€ë¦¬ ìš”ì²­ (í”„ë¡ì‹œ IP) -- > C[ì™¸ë¶€ ì›¹ ì„œë²„];
    C --> ì‘ë‹µ --> B;
    B --> ì‘ë‹µ ì „ë‹¬ --> A;

```

- **ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ (Reverse Proxy)** 
ìœ„ì¹˜ : ì›¹ ì„œë²„ ì• (ì£¼ë¡œ ì™¸ë¶€ë§ê³¼ ë‚´ë¶€ ì„œë²„ ì‚¬ì´)
ëŒ€ë¦¬ ëŒ€ìƒ : ì›¹ ì„œë²„(ëª©ì ì§€) ë³´í˜¸ ë° ì„±ëŠ¥ ìµœì í™” (ë³´ì•ˆ ê°•í™”, ë¡œë“œ ë°¸ëŸ°ì‹±, SSL/TLS ì²˜ë¦¬, ìºì‹±)
 ì‘ë™ : í´ë¼ì´ì–¸íŠ¸ê°€ í”„ë¡ì‹œì— ìš”ì²­í•˜ë©´, í”„ë¡ì‹œê°€ ë‚´ë¶€ ì„œë²„ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì—¬ ìš”ì²­ì„ ì „ë‹¬í•˜ê³  ì‘ë‹µì„ ë°›ì•„ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬
```
    A(í´ë¼ì´ì–¸íŠ¸(ì‚¬ìš©ì))
    B(ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„œë²„)
    C(ì›¹ ì„œë²„1)
    D(ì›¹ ì„œë²„2)
    
    B --> ìš”ì²­ ì „ë‹¬ --> C[ì›¹ ì„œë²„ 1];
    B --> ìš”ì²­ ì „ë‹¬ --> D[ì›¹ ì„œë²„ 2];
    C --> ì‘ë‹µ --> B;
    D --> ì‘ë‹µ --> B;
    B --> ì‘ë‹µ ì „ë‹¬ --> A;
```
- **ìš”ì•½**
í¬ì›Œë“œ í”„ë¡ì‹œ: ë‚´ë¶€ ì‚¬ìš©ìê°€ ì™¸ë¶€ë¡œ ë‚˜ê°ˆ ë•Œ í´ë¼ì´ì–¸íŠ¸ë¥¼ ë³´í˜¸. (ì™¸ë¶€ì—ì„œ í´ë¼ì´ì–¸íŠ¸ì˜ IPë¥¼ ëª¨ë¦„)
ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ: ì™¸ë¶€ ì‚¬ìš©ìê°€ ë‚´ë¶€ë¡œ ë“¤ì–´ì˜¬ ë•Œ ì›¹ ì„œë²„ë¥¼ ë³´í˜¸. (ì™¸ë¶€ì—ì„œ ë‚´ë¶€ ì„œë²„ì˜ IPë¥¼ ëª¨ë¦„)


## ì½”ë“œ / ì‹¤ìŠµ

```c
#include <stdio.h>
#include "csapp.h"

/* Recommended max cache and object sizes */
#define MAX_CACHE_SIZE 1049000
#define MAX_OBJECT_SIZE 102400

/* You won't lose style points for including this long line in your code */
static const char *user_agent_hdr =
    "User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:10.0.3) Gecko/20120305 "
    "Firefox/10.0.3\r\n";
///////////////////////////////////////////////////////////////////////////////////////////////////
/**
 *	@brief í•œ ê°œì˜ HTTP íŠ¸ëœì­ì…˜ì„ ì²˜ë¦¬
 *	@details
 *	@param clientfd í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°
 *	@return void(ë°˜í™˜ê°’ ì—†ìŒ)
 *	@throw ë°œìƒ ì˜ˆì™¸ ì—†ìŒ
 *
 */
void doit(int clientfd);

/**
 * @brief ì „ì²´ í—¤ë”ë“¤ì„ ë¹ˆì¤„ì„ ë§Œë‚ ë•Œê¹Œì§€ ì½ì–´ë“¤ì´ê³ , ì„œë²„ì— ì „ë‹¬
 * @details Host, Connection, Proxy-Connection í—¤ë”ëŠ” í”„ë¡ì‹œ ê·œì¹™ì— ë§ê²Œ ëŒ€ì²´/ìƒëµë¨
 * @param rp RIO(ë²„í¼ ì½ì–´ë“¤ì´ëŠ” êµ¬ì¡°ì²´) í¬ì¸í„° (í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ìš©)
 * @param serverfd í”„ë¡ì‹œê°€ ì—°ê²°í•œ ì„œë²„ ì†Œì¼“ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°
 * @param hostname Host í—¤ë”ê°€ ì—†ëŠ” ê²½ìš° ì‚¬ìš©í•  í˜¸ìŠ¤íŠ¸ ì´ë¦„
 * @return void(ë°˜í™˜ê°’ ì—†ìŒ)
 * @throw ë°œìƒ ì˜ˆì™¸ ì—†ìŒ
 * */
void read_requesthdrs(rio_t *rp, int serverfd, char *hostname); // ğŸ’¡ ì¸ì ë³€ê²½!

/**
 * @brief URLì„ íŒŒì‹±í•˜ì—¬ hostname, port, pathë¡œ ë¶„ë¦¬í•œë‹¤
 * @details
 * @param uri íŒŒì‹±í•  URL
 * @param hostname í˜¸ìŠ¤íŠ¸ ì´ë¦„ì´ ì €ì¥ë  ë²„í¼
 * @param port í¬íŠ¸ ë²ˆí˜¸ê°€ ì €ì¥ë  ë²„í¼
 * @param path ê²½ë¡œê°€ ì €ì¥ë  ë²„í¼
 * @return void(ë°˜í™˜ê°’ ì—†ìŒ)
 * @throw ë°œìƒ ì˜ˆì™¸ ì—†ìŒ
 */
void parse_uri(char *uri, char *hostname, char *port, char *path);
/////////////////////////////////////////////////////////////////////////////////////////////////////

/**
 *
 *	@brief ì„œë²„ êµ¬ë™, ìœ íš¨í•œ ì„œë²„ ì¸ì ê°’ì„ ë°›ê³  ì„œë²„ ìœ ì§€ë¥¼ ìœ„í•´ ë¬´í•œ ë°˜ë³µ í•œë‹¤.
 *	@details
 *	@param argc ìš´ì˜ì²´ì œì—ì„œ ì…ë ¥ ë°›ëŠ” ì¸ì ê°œìˆ˜
 *  @param argv [0]ëŠ” í”„ë¡œê·¸ë¨ ì´ë¦„, [1]ì€ í¬íŠ¸ë²ˆí˜¸
 *	@return int(ë°˜í™˜ê°’ ìˆìŒ)
 *	@throw ë°œìƒ ì˜ˆì™¸ ì—†ìŒ
 *
 */
int main(int argc, char **argv)
{
  int listenfd, connfd;
  char hostname[MAXLINE], port[MAXLINE];
  socklen_t clientlen;
  struct sockaddr_storage clientaddr;

  if (argc != 2) // ì„œë²„ ì¸ì í¬ê¸°ëŠ” í”„ë¡œê·¸ë¨ ì´ë¦„ + í¬íŠ¸ë²ˆí˜¸ë¡œ ë¬´ì¡°ê±´ 2ì—¬ì•¼ í•œë‹¤.
  {
    fprintf(stderr, "usage: %s <port>\n", argv[0]); // ë¬¸ì œì  ì•Œì•„ë‚´ê¸° ìœ„í•˜ì—¬ ì¶œë ¥
    exit(1);
  }

  listenfd = Open_listenfd(argv[1]); // í¬íŠ¸ì—ì„œ ì—°ê²° ìš”ì²­ì„ ê¸°ë‹¤ë¦¬ê¸° ìœ„í•œ listening socket ìƒì„±
  while (1)                          // ì„œë²„ëŠ” ìƒì‹œ ê°€ë™ìƒíƒœì—¬ì•¼ í•¨
  {
    clientlen = sizeof(clientaddr);                                                 // í´ë¼ì´ì–¸íŠ¸ ì£¼ì†Œ êµ¬ì¡°ì²´ í¬ê¸° ì„¤ì • (Accept í•¨ìˆ˜ì— í•„ìš”)
    connfd = Accept(listenfd, (SA *)&clientaddr, &clientlen);                       // í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ìˆ˜ë½í•˜ê³  í†µì‹ ìš© ì†Œì¼“ ìƒì„±
    Getnameinfo((SA *)&clientaddr, clientlen, hostname, MAXLINE, port, MAXLINE, 0); // í´ë¼ì´ì–¸íŠ¸ IPì™€ í¬íŠ¸ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜ (ë¡œê¹…ìš©)
    printf("Accepted connection from (%s, %s)\n", hostname, port);
    doit(connfd);  // í´ë¼ì´ì–¸íŠ¸ HTTP ìš”ì²­ ì²˜ë¦¬
    Close(connfd); // ì—°ê²° ì†Œì¼“ ë‹«ê¸°
  }
}

void doit(int clientfd)
{
  // 1. í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ ì½ê¸° (Tinyì™€ ë¹„ìŠ·)
  // 2. parse_uri í˜¸ì¶œ (ì™„ì„±!)
  // 3. ì„œë²„ì— ì—°ê²° (ìƒˆë¡œ êµ¬í˜„)
  // 4. ì„œë²„ì— ìš”ì²­ ì „ë‹¬ (ìƒˆë¡œ êµ¬í˜„)
  // 5. ì„œë²„ ì‘ë‹µì„ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬ (ìƒˆë¡œ êµ¬í˜„)

  char buf[MAXLINE], method[MAXLINE], uri[MAXLINE], version[MAXLINE];
  char hostname[MAXLINE], port[MAXLINE], path[MAXLINE];
  rio_t client_rio;
  int serverfd, n;
  Rio_readinitb(&client_rio, clientfd);
  Rio_readlineb(&client_rio, buf, MAXLINE);

  printf("Request: %s", buf);
  sscanf(buf, "%s %s %s", method, uri, version);

  // GET ë©”ì†Œë“œë§Œ ì²˜ë¦¬
  if (strcasecmp(method, "GET"))
  {
    fprintf(stderr, "Proxy only handles GET requests.\n");
    // read_requesthdrs(client_rio, -1, NULL); // GETì´ ì•„ë‹ˆì–´ë„ í—¤ë”ëŠ” ì½ì–´ ë²„í¼ë¥¼ ë¹„ì›Œì•¼ í•¨
    return; // ê°„ë‹¨í•˜ê²Œ GET ì´ì™¸ëŠ” ì²˜ë¦¬ ì•ˆ í•¨
  }

  parse_uri(uri, hostname, port, path);

  printf("Hostname: %s\n", hostname);
  printf("Port: %s\n", port);
  printf("Path: %s\n", path);

  if (strcmp(hostname, "INVALID_HOST") == 0) {
        fprintf(stderr, "Error: URI must be absolute (e.g., http://www.site.com/). Aborting server connection.\n");
        return; // ì—¬ê¸°ì„œ doit í•¨ìˆ˜ë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤.
  }

  serverfd = Open_clientfd(hostname, port);

  printf("Connected to server!\n");

  // ì„œë²„ì— ìš”ì²­ ë¼ì¸ ë³´ë‚´ê¸° (HTTP/1.0 ì‚¬ìš©)
  sprintf(buf, "%s %s HTTP/1.0\r\n", method, path);
  Rio_writen(serverfd, buf, strlen(buf));

  // ğŸ’¡ í´ë¼ì´ì–¸íŠ¸ì˜ ë‚˜ë¨¸ì§€ í—¤ë”ë“¤ì„ ì½ì–´ì„œ ì„œë²„ì— ì „ë‹¬í•˜ê³  í•„ìˆ˜ í—¤ë”ë¥¼ ëŒ€ì²´
  read_requesthdrs(&client_rio, serverfd, hostname);

  printf("Request sent to server!\n");

  rio_t server_rio;
  Rio_readinitb(&server_rio, serverfd);

  // ì„œë²„ ì‘ë‹µ ì½ì–´ì„œ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬
  while ((n = Rio_readnb(&server_rio, buf, MAXLINE)) > 0)
  {
    Rio_writen(clientfd, buf, n);
    printf("Forwarded %d bytes\n", n);
  }

  Close(serverfd);
}

void parse_uri(char *uri, char *hostname, char *port, char *path)
{
  char *ptr, *colonPlace, *slashPlace;

  // 1. "http://" ê±´ë„ˆë›°ê¸°
  ptr = strstr(uri, "//");
  if (ptr == NULL)
  {
    // ğŸ’¡ ìˆ˜ì •: íŒŒì‹± ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ê°’ ì„¤ì •
    printf("URI: [%s]\n", uri);
    // hostnameì„ ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ì´ë¥¼ ì•Œë¦¬ëŠ” íŠ¹ìˆ˜ ê°’ìœ¼ë¡œ ì„¤ì •
    strcpy(hostname, "INVALID_HOST");
    strcpy(port, "80");

    // URIì— ê²½ë¡œê°€ ë‚¨ì•„ìˆë‹¤ë©´ ì‚¬ìš© (GET / HTTP/1.1 ì¼ ê²½ìš°)
    if (uri[0] == '/')
    {
      strcpy(path, uri);
    }
    else
    {
      strcpy(path, "/");
    }
    return;
  }
  ptr += 2; // "localhost:8080/index.html"

  // 2. ':' ì™€ '/' ìœ„ì¹˜ ì°¾ê¸°
  colonPlace = strchr(ptr, ':');
  slashPlace = strchr(ptr, '/');

  // 3. hostname ì¶”ì¶œ
  if (colonPlace != NULL)
  {
    // hostnameì€ ptr ~ colonPos ì „ê¹Œì§€
    int len = colonPlace - ptr;
    strncpy(hostname, ptr, len);
    hostname[len] = '\0';
  }
  else if (slashPlace != NULL)
  {
    // hostnameì€ ptr ~ slashPos ì „ê¹Œì§€
    int len = slashPlace - ptr;
    strncpy(hostname, ptr, len);
    hostname[len] = '\0';
  }
  else
  {
    // hostnameì€ ptr ~ ëê¹Œì§€
    strcpy(hostname, ptr);
  }

  // 4. port ì¶”ì¶œ
  if (colonPlace != NULL)
  {
    ptr = colonPlace + 1;
    if (slashPlace != NULL)
    {
      int len = slashPlace - ptr;
      strncpy(port, ptr, len);
      port[len] = '\0';
    }
    else
    {
      strcpy(port, ptr);
    }
  }
  else
  {
    strcpy(port, "80");
  }

  // 5. path ì¶”ì¶œ
  if (slashPlace != NULL)
  {
    strcpy(path, slashPlace);
  }
  else
  {
    strcpy(path, "/");
  }
}

void read_requesthdrs(rio_t *rp, int serverfd, char *hostname)
{
  char buf[MAXLINE];
  int host_flag = 0;

  // 1. í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚¸ í—¤ë”ë“¤ì„ ì½ìŒ
  while (Rio_readlineb(rp, buf, MAXLINE) > 0 && strcmp(buf, "\r\n"))
  {
    // 2. Host, Connection, Proxy-Connection, User-AgentëŠ” ë¬´ì‹œ (í”„ë¡ì‹œ ê·œì¹™ìœ¼ë¡œ ë®ì–´ì“¸ ì˜ˆì •)
    if (!strncasecmp(buf, "Host:", 5))
    {
      host_flag = 1;
    }
    else if (
        !strncasecmp(buf, "Connection:", 11) ||
        !strncasecmp(buf, "Proxy-Connection:", 17) ||
        !strncasecmp(buf, "User-Agent:", 11))
    {
      // ë¬´ì‹œ
    }
    else
    {
      // 3. ë‚˜ë¨¸ì§€ í—¤ë”ëŠ” ì„œë²„ì— ê·¸ëŒ€ë¡œ ì „ë‹¬
      Rio_writen(serverfd, buf, strlen(buf));
    }
    printf("%s", buf); // ë¡œê¹…
  }

  // 4. í”„ë¡ì‹œ ê·œì¹™ì— ë”°ë¥¸ í•„ìˆ˜ í—¤ë”ë¥¼ ì„œë²„ì— ì¶”ê°€
  // Host (Host í—¤ë”ê°€ ì—†ì—ˆì„ ê²½ìš°ì—ë§Œ ì¶”ê°€)
  if (!host_flag)
  {
    sprintf(buf, "Host: %s\r\n", hostname);
    Rio_writen(serverfd, buf, strlen(buf));
  }

  // User-Agent
  sprintf(buf, "%s", user_agent_hdr);
  Rio_writen(serverfd, buf, strlen(buf));

  // Connection ë° Proxy-Connection
  sprintf(buf, "Connection: close\r\n");
  Rio_writen(serverfd, buf, strlen(buf));

  sprintf(buf, "Proxy-Connection: close\r\n");
  Rio_writen(serverfd, buf, strlen(buf));

  // 5. í—¤ë”ì˜ ëì„ ì•Œë¦¬ëŠ” ë¹ˆ ì¤„ì„ ì „ì†¡
  sprintf(buf, "\r\n");
  Rio_writen(serverfd, buf, strlen(buf));
}
```